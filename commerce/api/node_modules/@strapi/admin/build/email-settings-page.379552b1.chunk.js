"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[1495],{15857:function(A,f,t){t.r(f),t.d(f,{default:function(){return Q}});var e=t(32735),p=t(5636),a=t(88425),m=t(27649),d=t(17e3),g=t(27677),T=t(72850),x=t(15335),E=t(5803),b=t(49372),h=t(10369),B=t(41415),y=t(94638),s=t(7961),c=t(60216),l=t.n(c),o=t(83292),u=t(70218),v=t(84967),i=t(85684);const R=o.default.a`
  color: ${({theme:n})=>n.colors.primary600};
`,C=({config:n})=>{const{formatMessage:r}=(0,p.useIntl)();return e.createElement(g.K,{spacing:4},e.createElement(g.K,{spacing:1},e.createElement(b.Z,{variant:"delta",as:"h2"},r({id:(0,i.Z)("Settings.email.plugin.title.config"),defaultMessage:"Configuration"})),e.createElement(b.Z,null,r({id:(0,i.Z)("Settings.email.plugin.text.configuration"),defaultMessage:"The plugin is configured through the {file} file, checkout this {link} for the documentation."},{file:"./config/plugins.js",link:e.createElement(R,{href:"https://docs.strapi.io/developer-docs/latest/plugins/email.html",target:"_blank",rel:"noopener noreferrer"},r({id:(0,i.Z)("link"),defaultMessage:"Link"}))}))),e.createElement(x.r,{gap:5},e.createElement(E.P,{col:6,s:12},e.createElement(h.o,{name:"shipper-email",label:r({id:(0,i.Z)("Settings.email.plugin.label.defaultFrom"),defaultMessage:"Default sender email"}),placeholder:r({id:(0,i.Z)("Settings.email.plugin.placeholder.defaultFrom"),defaultMessage:"ex: Strapi No-Reply '<'no-reply@strapi.io'>'"}),disabled:!0,onChange:()=>{},value:n.settings.defaultFrom})),e.createElement(E.P,{col:6,s:12},e.createElement(h.o,{name:"response-email",label:r({id:(0,i.Z)("Settings.email.plugin.label.defaultReplyTo"),defaultMessage:"Default response email"}),placeholder:r({id:(0,i.Z)("Settings.email.plugin.placeholder.defaultReplyTo"),defaultMessage:"ex: Strapi '<'example@strapi.io'>'"}),disabled:!0,onChange:()=>{},value:n.settings.defaultReplyTo})),e.createElement(E.P,{col:6,s:12},e.createElement(u.P,{name:"email-provider",label:r({id:(0,i.Z)("Settings.email.plugin.label.provider"),defaultMessage:"Email provider"}),disabled:!0,onChange:()=>{},value:n.provider},e.createElement(v.W,{value:n.provider},n.provider)))))};C.propTypes={config:l().shape({provider:l().string,settings:l().shape({defaultFrom:l().string,defaultReplyTo:l().string})}).isRequired};var Z=C,I=t(5173),O=I.Ry().shape({email:I.Z_().email(a.translatedErrors.email).required(a.translatedErrors.required)}),N=t(59990),V=t(55721);const D=V.Z.create({baseURL:"http://localhost:1337"});D.interceptors.request.use(async n=>(n.headers={Authorization:`Bearer ${a.auth.getToken()}`,Accept:"application/json","Content-Type":"application/json"},n),n=>{Promise.reject(n)}),D.interceptors.response.use(n=>n,n=>{throw n.response?.status===401&&(a.auth.clearAppStorage(),window.location.reload()),n});var F=(0,a.wrapAxiosInstance)(D);const $=async()=>{const{data:n}=await F.get("/email/settings");return n.config},G=async n=>{await F.post("/email/test",n)};var k=t(28356),j=()=>{const{formatMessage:n}=(0,p.useIntl)();return e.createElement(e.Fragment,null,e.createElement(a.SettingsPageTitle,{name:n({id:(0,i.Z)("Settings.email.plugin.title"),defaultMessage:"Configuration"})}),e.createElement(k.T,{id:"title",title:n({id:(0,i.Z)("Settings.email.plugin.title"),defaultMessage:"Configuration"}),subtitle:n({id:(0,i.Z)("Settings.email.plugin.subTitle"),defaultMessage:"Test the settings for the Email plugin"})}))};const Y=()=>e.createElement(a.CheckPagePermissions,{permissions:N.Z.settings},e.createElement(J,null)),J=()=>{const n=(0,a.useNotification)(),{formatMessage:r}=(0,p.useIntl)(),{lockApp:X,unlockApp:q}=(0,a.useOverlayBlocker)(),{notifyStatus:w}=(0,y.G)();(0,a.useFocusWhenNavigate)();const[P,_]=(0,e.useState)({}),[ee,K]=(0,e.useState)(!1),[z,H]=(0,e.useState)(!1),[S,W]=(0,e.useState)(""),[te,U]=(0,e.useState)(!1),[ae,ne]=(0,e.useState)({provider:"",settings:{defaultFrom:"",defaultReplyTo:"",testAddress:""}});(0,e.useEffect)(()=>{K(!0),$().then(M=>{w(r({id:(0,i.Z)("Settings.email.plugin.notification.data.loaded"),defaultMessage:"Email settings data has been loaded"})),ne(M);const L=M?.settings?.testAddress;L&&W(L)}).catch(()=>n({type:"warning",message:r({id:(0,i.Z)("Settings.email.plugin.notification.config.error"),defaultMessage:"Failed to retrieve the email config"})})).finally(()=>K(!1))},[r,n,w]),(0,e.useEffect)(()=>{P.email&&document.querySelector("#test-address-input").focus()},[P]),(0,e.useEffect)(()=>{O.validate({email:S},{abortEarly:!1}).then(()=>U(!0)).catch(()=>U(!1))},[S]);const se=M=>{W(()=>M.target.value)},ie=async M=>{M.preventDefault();try{await O.validate({email:S},{abortEarly:!1}),H(!0),X(),G({to:S}).then(()=>{n({type:"success",message:r({id:(0,i.Z)("Settings.email.plugin.notification.test.success"),defaultMessage:"Email test succeeded, check the {to} mailbox"},{to:S})})}).catch(()=>{n({type:"warning",message:r({id:(0,i.Z)("Settings.email.plugin.notification.test.error"),defaultMessage:"Failed to send a test mail to {to}"},{to:S})})}).finally(()=>{H(!1),q()})}catch(L){_((0,a.getYupInnerErrors)(L))}};return ee?e.createElement(m.o,{labelledBy:"title","aria-busy":"true"},e.createElement(j,null),e.createElement(d.D,null,e.createElement(a.LoadingIndicatorPage,null))):e.createElement(m.o,{labelledBy:"title","aria-busy":z},e.createElement(j,null),e.createElement(d.D,null,e.createElement("form",{onSubmit:ie},e.createElement(g.K,{spacing:7},e.createElement(T.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(Z,{config:ae})),e.createElement(T.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(g.K,{spacing:4},e.createElement(b.Z,{variant:"delta",as:"h2"},r({id:(0,i.Z)("Settings.email.plugin.title.test"),defaultMessage:"Test email delivery"})),e.createElement(x.r,{gap:5,alignItems:"end"},e.createElement(E.P,{col:6,s:12},e.createElement(h.o,{id:"test-address-input",name:"test-address",onChange:se,label:r({id:(0,i.Z)("Settings.email.plugin.label.testAddress"),defaultMessage:"Recipient email"}),value:S,error:P.email?.id&&r({id:(0,i.Z)(`${P.email?.id}`),defaultMessage:"This is an invalid email"}),placeholder:r({id:(0,i.Z)("Settings.email.plugin.placeholder.testAddress"),defaultMessage:"ex: developer@example.com"})})),e.createElement(E.P,{col:7,s:12},e.createElement(B.z,{loading:z,disabled:!te,type:"submit",startIcon:e.createElement(s.Z,null)},r({id:(0,i.Z)("Settings.email.plugin.button.test-email"),defaultMessage:"Send test email"}))))))))))};var Q=Y},17e3:function(A,f,t){t.d(f,{D:function(){return m}});var e=t(32735),p=t(60216),a=t(72850);const m=({children:d})=>e.createElement(a.x,{paddingLeft:10,paddingRight:10},d);m.propTypes={children:p.node.isRequired}},28356:function(A,f,t){t.d(f,{T:function(){return h}});var e=t(32735),p=t(83292),a=t(60216),m=t(49372),d=t(72850),g=t(87933);const T=s=>{const c=(0,e.useRef)(null),[l,o]=(0,e.useState)(!0),u=([v])=>{o(v.isIntersecting)};return(0,e.useEffect)(()=>{const v=c.current,i=new IntersectionObserver(u,s);return v&&i.observe(c.current),()=>{v&&i.disconnect()}},[c,s]),[c,l]};var x=t(81002);const E=(s,c)=>{const l=(0,x.useCallbackRef)(c);(0,e.useLayoutEffect)(()=>{const o=new ResizeObserver(l);return Array.isArray(s)?s.forEach(u=>{u.current&&o.observe(u.current)}):s.current&&o.observe(s.current),()=>{o.disconnect()}},[s,l])},b=()=>{const s=(0,e.useRef)(null),[c,l]=(0,e.useState)(null),[o,u]=T({root:null,rootMargin:"0px",threshold:0});return E(o,()=>{o.current&&l(o.current.getBoundingClientRect())}),(0,e.useEffect)(()=>{s.current&&l(s.current.getBoundingClientRect())},[s]),{containerRef:o,isVisible:u,baseHeaderLayoutRef:s,headerSize:c}},h=s=>{const{containerRef:c,isVisible:l,baseHeaderLayoutRef:o,headerSize:u}=b();return e.createElement(e.Fragment,null,e.createElement("div",{style:{height:u?.height},ref:c},l&&e.createElement(y,{ref:o,...s})),!l&&e.createElement(y,{...s,sticky:!0,width:u?.width}))};h.displayName="HeaderLayout";const B=(0,p.default)(d.x)`
  position: fixed;
  top: 0;
  right: 0;
  width: ${s=>s.width}px;
  z-index: 4;
  box-shadow: ${({theme:s})=>s.shadows.tableShadow};
`,y=e.forwardRef(({navigationAction:s,primaryAction:c,secondaryAction:l,subtitle:o,title:u,sticky:v,width:i,...R},C)=>{const Z=typeof o=="string";return v?e.createElement(B,{paddingLeft:6,paddingRight:6,paddingTop:3,paddingBottom:3,background:"neutral0",width:i,"data-strapi-header-sticky":!0},e.createElement(g.k,{justifyContent:"space-between"},e.createElement(g.k,null,s&&e.createElement(d.x,{paddingRight:3},s),e.createElement(d.x,null,e.createElement(m.Z,{variant:"beta",as:"h1",...R},u),Z?e.createElement(m.Z,{variant:"pi",textColor:"neutral600"},o):o),l?e.createElement(d.x,{paddingLeft:4},l):null),e.createElement(g.k,null,c?e.createElement(d.x,{paddingLeft:2},c):void 0))):e.createElement(d.x,{ref:C,paddingLeft:10,paddingRight:10,paddingBottom:8,paddingTop:s?6:8,background:"neutral100","data-strapi-header":!0},s?e.createElement(d.x,{paddingBottom:2},s):null,e.createElement(g.k,{justifyContent:"space-between"},e.createElement(g.k,null,e.createElement(m.Z,{as:"h1",variant:"alpha",...R},u),l?e.createElement(d.x,{paddingLeft:4},l):null),c),Z?e.createElement(m.Z,{variant:"epsilon",textColor:"neutral600",as:"p"},o):o)});y.displayName="BaseHeaderLayout",y.defaultProps={navigationAction:void 0,primaryAction:void 0,secondaryAction:void 0,subtitle:void 0,sticky:!1,width:void 0},y.propTypes={navigationAction:a.node,primaryAction:a.node,secondaryAction:a.node,sticky:a.bool,subtitle:a.oneOfType([a.string,a.node]),title:a.string.isRequired,width:a.number},h.defaultProps={navigationAction:void 0,primaryAction:void 0,secondaryAction:void 0,subtitle:void 0},h.propTypes={navigationAction:a.node,primaryAction:a.node,secondaryAction:a.node,subtitle:a.oneOfType([a.string,a.node]),title:a.string.isRequired}},27649:function(A,f,t){t.d(f,{o:function(){return d}});var e=t(32735),p=t(60216),a=t(83292);const m=a.default.main`
  // To prevent global outline on focus visible to force an outline when Main is focused
  &:focus-visible {
    outline: none;
  }
`,d=({labelledBy:g,...T})=>{const x=g||"main-content-title";return e.createElement(m,{"aria-labelledby":x,id:"main-content",tabIndex:-1,...T})};d.defaultProps={labelledBy:void 0},d.propTypes={labelledBy:p.string}},7961:function(A,f,t){t.d(f,{Z:function(){return p}});var e=t(74512);function p(a){return(0,e.jsxs)("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a,children:[(0,e.jsx)("path",{d:"M0 2.8A.8.8 0 01.8 2h22.4a.8.8 0 01.8.8v2.71a1 1 0 01-1 1H1a1 1 0 01-1-1V2.8z",fill:"#32324D"}),(0,e.jsx)("path",{d:"M1.922 7.991C.197 6.675 0 6.252 0 5.289h23.953c.305 1.363-1.594 2.506-2.297 3.125-1.953 1.363-6.253 4.36-7.828 5.45-1.575 1.09-3.031.455-3.562 0-2.063-1.41-6.62-4.557-8.344-5.873zM22.8 18H1.2c-.663 0-1.2.471-1.2 1.053v1.894C0 21.529.537 22 1.2 22h21.6c.663 0 1.2-.471 1.2-1.053v-1.894c0-.582-.537-1.053-1.2-1.053z",fill:"#32324D"}),(0,e.jsx)("path",{d:"M0 9.555v10.972h24V9.554c-2.633 1.95-8.367 6.113-9.96 7.166-1.595 1.052-3.352.438-4.032 0L0 9.555z",fill:"#32324D"})]})}}}]);
