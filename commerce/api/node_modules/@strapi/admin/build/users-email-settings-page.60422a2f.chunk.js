"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[8418],{218:function(b,g,t){t.r(g),t.d(g,{default:function(){return oe}});var e=t(32735),m=t(84968),s=t(5636),n=t(88425),i=t(94638),o=t(27649),T=t(28356),M=t(17e3),v=t(88369),l=t(59677);const p=async()=>{const{data:u}=await l.be.get((0,l.Gc)("email-templates"));return u},O=u=>l.be.put((0,l.Gc)("email-templates"),u);var h=t(60216),a=t.n(h),c=t(94745),E=t(76330),r=t(29005),d=t(66735),R=t(3594),L=t(3685),I=t(49372),Z=t(50563),U=t(99140),$=t(68625),Q=t(44647),J=t(66456);const K=({canUpdate:u,onEditClick:P})=>{const{formatMessage:f}=(0,s.useIntl)();return e.createElement(c.i,{colCount:3,rowCount:3},e.createElement(E.h,null,e.createElement(r.Tr,null,e.createElement(d.Th,{width:"1%"},e.createElement(L.T,null,f({id:(0,l.OB)("Email.template.table.icon.label"),defaultMessage:"icon"}))),e.createElement(d.Th,null,e.createElement(I.Z,{variant:"sigma",textColor:"neutral600"},f({id:(0,l.OB)("Email.template.table.name.label"),defaultMessage:"name"}))),e.createElement(d.Th,{width:"1%"},e.createElement(L.T,null,f({id:(0,l.OB)("Email.template.table.action.label"),defaultMessage:"action"}))))),e.createElement(R.p,null,e.createElement(r.Tr,{...(0,n.onRowClick)({fn:()=>P("reset_password")})},e.createElement(d.Td,null,e.createElement(U.J,null,e.createElement(Q.Z,{"aria-label":f({id:"global.reset-password",defaultMessage:"Reset password"})}))),e.createElement(d.Td,null,e.createElement(I.Z,null,f({id:"global.reset-password",defaultMessage:"Reset password"}))),e.createElement(d.Td,{...n.stopPropagation},e.createElement(Z.h,{onClick:()=>P("reset_password"),label:f({id:(0,l.OB)("Email.template.form.edit.label"),defaultMessage:"Edit a template"}),noBorder:!0,icon:u&&e.createElement($.Z,null)}))),e.createElement(r.Tr,{...(0,n.onRowClick)({fn:()=>P("email_confirmation")})},e.createElement(d.Td,null,e.createElement(U.J,null,e.createElement(J.Z,{"aria-label":f({id:(0,l.OB)("Email.template.email_confirmation"),defaultMessage:"Email address confirmation"})}))),e.createElement(d.Td,null,e.createElement(I.Z,null,f({id:(0,l.OB)("Email.template.email_confirmation"),defaultMessage:"Email address confirmation"}))),e.createElement(d.Td,{...n.stopPropagation},e.createElement(Z.h,{onClick:()=>P("email_confirmation"),label:f({id:(0,l.OB)("Email.template.form.edit.label"),defaultMessage:"Edit a template"}),noBorder:!0,icon:u&&e.createElement($.Z,null)})))))};K.propTypes={canUpdate:a().bool.isRequired,onEditClick:a().func.isRequired};var X=K,Y=t(83281),w=t(85025),k=t(55225),q=t(31600),_=t(11406),ee=t(15335),j=t(5803),H=t(41415),S=t(11299),te=t(10508),x=t(5173),ae=x.Ry().shape({options:x.Ry().shape({from:x.Ry().shape({name:x.Z_().required(n.translatedErrors.required),email:x.Z_().email(n.translatedErrors.email).required(n.translatedErrors.required)}).required(),response_email:x.Z_().email(n.translatedErrors.email),object:x.Z_().required(n.translatedErrors.required),message:x.Z_().required(n.translatedErrors.required)}).required(n.translatedErrors.required)});const N=({template:u,onToggle:P,onSubmit:f})=>{const{formatMessage:y}=(0,s.useIntl)();return e.createElement(w.P,{onClose:P,labelledBy:`${y({id:(0,l.OB)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})}, ${y({id:(0,l.OB)(u.display),defaultMessage:u.display})}`},e.createElement(k.x,null,e.createElement(S.O,{label:`${y({id:(0,l.OB)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})}, ${y({id:(0,l.OB)(u.display),defaultMessage:u.display})}`},e.createElement(S.$,null,y({id:(0,l.OB)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})),e.createElement(S.$,null,y({id:(0,l.OB)(u.display),defaultMessage:u.display})))),e.createElement(Y.Formik,{onSubmit:f,initialValues:u,validateOnChange:!1,validationSchema:ae,enableReinitialize:!0},({errors:B,values:C,handleChange:A,isSubmitting:F})=>e.createElement(n.Form,null,e.createElement(q.f,null,e.createElement(ee.r,{gap:5},e.createElement(j.P,{col:6,s:12},e.createElement(n.GenericInput,{intlLabel:{id:(0,l.OB)("PopUpForm.Email.options.from.name.label"),defaultMessage:"Shipper name"},name:"options.from.name",onChange:A,value:C.options.from.name,error:B?.options?.from?.name,type:"text"})),e.createElement(j.P,{col:6,s:12},e.createElement(n.GenericInput,{intlLabel:{id:(0,l.OB)("PopUpForm.Email.options.from.email.label"),defaultMessage:"Shipper email"},name:"options.from.email",onChange:A,value:C.options.from.email,error:B?.options?.from?.email,type:"text"})),e.createElement(j.P,{col:6,s:12},e.createElement(n.GenericInput,{intlLabel:{id:(0,l.OB)("PopUpForm.Email.options.response_email.label"),defaultMessage:"Response email"},name:"options.response_email",onChange:A,value:C.options.response_email,error:B?.options?.response_email,type:"text"})),e.createElement(j.P,{col:6,s:12},e.createElement(n.GenericInput,{intlLabel:{id:(0,l.OB)("PopUpForm.Email.options.object.label"),defaultMessage:"Subject"},name:"options.object",onChange:A,value:C.options.object,error:B?.options?.object,type:"text"})),e.createElement(j.P,{col:12,s:12},e.createElement(te.g,{label:y({id:(0,l.OB)("PopUpForm.Email.options.message.label"),defaultMessage:"Message"}),name:"options.message",onChange:A,value:C.options.message,error:B?.options?.message&&y({id:B.options.message,defaultMessage:B.options.message})})))),e.createElement(_.m,{startActions:e.createElement(H.z,{onClick:P,variant:"tertiary"},"Cancel"),endActions:e.createElement(H.z,{loading:F,type:"submit"},"Finish")}))))};N.propTypes={template:a().shape({display:a().string,icon:a().string,options:a().shape({from:a().shape({name:a().string,email:a().string}),message:a().string,object:a().string,response_email:a().string})}).isRequired,onSubmit:a().func.isRequired,onToggle:a().func.isRequired};var ne=N;const le=()=>e.createElement(n.CheckPagePermissions,{permissions:v.Z.readEmailTemplates},e.createElement(se,null)),se=()=>{const{formatMessage:u}=(0,s.useIntl)(),{trackUsage:P}=(0,n.useTracking)(),{notifyStatus:f}=(0,i.G)(),y=(0,n.useNotification)(),{lockApp:B,unlockApp:C}=(0,n.useOverlayBlocker)(),A=(0,e.useRef)(P),F=(0,m.useQueryClient)();(0,n.useFocusWhenNavigate)();const[ie,re]=(0,e.useState)(!1),[z,de]=(0,e.useState)(null),me=(0,e.useMemo)(()=>({update:v.Z.updateEmailTemplates}),[]),{isLoading:ce,allowedActions:{canUpdate:ue}}=(0,n.useRBAC)(me),{status:pe,data:G}=(0,m.useQuery)("email-templates",()=>p(),{onSuccess(){f(u({id:(0,l.OB)("Email.template.data.loaded"),defaultMessage:"Email templates has been loaded"}))},onError(){y({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),Ee=ce||pe!=="success",W=()=>{re(D=>!D)},ge=D=>{de(D),W()},V=(0,m.useMutation)(D=>O({"email-templates":D}),{async onSuccess(){await F.invalidateQueries("email-templates"),y({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}}),A.current("didEditEmailTemplates"),C(),W()},onError(){y({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}}),C()},refetchActive:!0}),{isLoading:fe}=V,ve=D=>{B(),A.current("willEditEmailTemplates");const he={...G,[z]:D};V.mutate(he)};return Ee?e.createElement(o.o,{"aria-busy":"true"},e.createElement(n.SettingsPageTitle,{name:u({id:(0,l.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(T.T,{title:u({id:(0,l.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(M.D,null,e.createElement(n.LoadingIndicatorPage,null))):e.createElement(o.o,{"aria-busy":fe},e.createElement(n.SettingsPageTitle,{name:u({id:(0,l.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(T.T,{title:u({id:(0,l.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(M.D,null,e.createElement(X,{onEditClick:ge,canUpdate:ue}),ie&&e.createElement(ne,{template:G[z],onToggle:W,onSubmit:ve})))};var oe=le},8917:function(b,g,t){var e=t(55721),m=t(88425),s=t.n(m);const n=e.Z.create({baseURL:"http://localhost:1337"});n.interceptors.request.use(async o=>(o.headers={Authorization:`Bearer ${m.auth.getToken()}`,Accept:"application/json","Content-Type":"application/json"},o),o=>{Promise.reject(o)}),n.interceptors.response.use(o=>o,o=>{throw o.response?.status===401&&(m.auth.clearAppStorage(),window.location.reload()),o});const i=(0,m.wrapAxiosInstance)(n);g.Z=i},59677:function(b,g,t){t.d(g,{be:function(){return e.Z},YX:function(){return n},Gc:function(){return T},OB:function(){return M.Z}});var e=t(8917),m=t(92891),n=v=>Object.keys(v).reduce((l,p)=>{const O=v[p].controllers,h=Object.keys(O).reduce((a,c)=>((0,m.isEmpty)(O[c])||(a[c]=O[c]),a),{});return(0,m.isEmpty)(h)||(l[p]={controllers:h}),l},{}),i=t(90201),T=v=>`/${i.Z}/${v}`,M=t(82069)},11299:function(b,g,t){t.d(g,{$:function(){return v},O:function(){return l}});var e=t(74512),m=t(83292),s=t(57269),n=t(49372),i=t(72850),o=t(87933),T=t(3685);const M=(0,m.default)(o.k)`
  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
    path {
      fill: ${({theme:p})=>p.colors.neutral500};
    }
  }
  :last-of-type ${i.x} {
    display: none;
  }
  :last-of-type ${n.Z} {
    color: ${({theme:p})=>p.colors.neutral800};
    font-weight: ${({theme:p})=>p.fontWeights.bold};
  }
`,v=({children:p})=>(0,e.jsxs)(M,{inline:!0,as:"li",children:[(0,e.jsx)(n.Z,{variant:"pi",textColor:"neutral600",children:p}),(0,e.jsx)(i.x,{"aria-hidden":!0,paddingLeft:3,paddingRight:3,children:(0,e.jsx)(s.ChevronRight,{})})]});v.displayName="Crumb";const l=({children:p,label:O,...h})=>(0,e.jsxs)(o.k,{...h,children:[(0,e.jsx)(T.T,{children:O}),(0,e.jsx)("ol",{"aria-hidden":!0,children:p})]});l.displayName="Breadcrumbs"},17e3:function(b,g,t){t.d(g,{D:function(){return n}});var e=t(32735),m=t(60216),s=t(72850);const n=({children:i})=>e.createElement(s.x,{paddingLeft:10,paddingRight:10},i);n.propTypes={children:m.node.isRequired}},28356:function(b,g,t){t.d(g,{T:function(){return p}});var e=t(32735),m=t(83292),s=t(60216),n=t(49372),i=t(72850),o=t(87933);const T=a=>{const c=(0,e.useRef)(null),[E,r]=(0,e.useState)(!0),d=([R])=>{r(R.isIntersecting)};return(0,e.useEffect)(()=>{const R=c.current,L=new IntersectionObserver(d,a);return R&&L.observe(c.current),()=>{R&&L.disconnect()}},[c,a]),[c,E]};var M=t(81002);const v=(a,c)=>{const E=(0,M.useCallbackRef)(c);(0,e.useLayoutEffect)(()=>{const r=new ResizeObserver(E);return Array.isArray(a)?a.forEach(d=>{d.current&&r.observe(d.current)}):a.current&&r.observe(a.current),()=>{r.disconnect()}},[a,E])},l=()=>{const a=(0,e.useRef)(null),[c,E]=(0,e.useState)(null),[r,d]=T({root:null,rootMargin:"0px",threshold:0});return v(r,()=>{r.current&&E(r.current.getBoundingClientRect())}),(0,e.useEffect)(()=>{a.current&&E(a.current.getBoundingClientRect())},[a]),{containerRef:r,isVisible:d,baseHeaderLayoutRef:a,headerSize:c}},p=a=>{const{containerRef:c,isVisible:E,baseHeaderLayoutRef:r,headerSize:d}=l();return e.createElement(e.Fragment,null,e.createElement("div",{style:{height:d?.height},ref:c},E&&e.createElement(h,{ref:r,...a})),!E&&e.createElement(h,{...a,sticky:!0,width:d?.width}))};p.displayName="HeaderLayout";const O=(0,m.default)(i.x)`
  position: fixed;
  top: 0;
  right: 0;
  width: ${a=>a.width}px;
  z-index: 4;
  box-shadow: ${({theme:a})=>a.shadows.tableShadow};
`,h=e.forwardRef(({navigationAction:a,primaryAction:c,secondaryAction:E,subtitle:r,title:d,sticky:R,width:L,...I},Z)=>{const U=typeof r=="string";return R?e.createElement(O,{paddingLeft:6,paddingRight:6,paddingTop:3,paddingBottom:3,background:"neutral0",width:L,"data-strapi-header-sticky":!0},e.createElement(o.k,{justifyContent:"space-between"},e.createElement(o.k,null,a&&e.createElement(i.x,{paddingRight:3},a),e.createElement(i.x,null,e.createElement(n.Z,{variant:"beta",as:"h1",...I},d),U?e.createElement(n.Z,{variant:"pi",textColor:"neutral600"},r):r),E?e.createElement(i.x,{paddingLeft:4},E):null),e.createElement(o.k,null,c?e.createElement(i.x,{paddingLeft:2},c):void 0))):e.createElement(i.x,{ref:Z,paddingLeft:10,paddingRight:10,paddingBottom:8,paddingTop:a?6:8,background:"neutral100","data-strapi-header":!0},a?e.createElement(i.x,{paddingBottom:2},a):null,e.createElement(o.k,{justifyContent:"space-between"},e.createElement(o.k,null,e.createElement(n.Z,{as:"h1",variant:"alpha",...I},d),E?e.createElement(i.x,{paddingLeft:4},E):null),c),U?e.createElement(n.Z,{variant:"epsilon",textColor:"neutral600",as:"p"},r):r)});h.displayName="BaseHeaderLayout",h.defaultProps={navigationAction:void 0,primaryAction:void 0,secondaryAction:void 0,subtitle:void 0,sticky:!1,width:void 0},h.propTypes={navigationAction:s.node,primaryAction:s.node,secondaryAction:s.node,sticky:s.bool,subtitle:s.oneOfType([s.string,s.node]),title:s.string.isRequired,width:s.number},p.defaultProps={navigationAction:void 0,primaryAction:void 0,secondaryAction:void 0,subtitle:void 0},p.propTypes={navigationAction:s.node,primaryAction:s.node,secondaryAction:s.node,subtitle:s.oneOfType([s.string,s.node]),title:s.string.isRequired}},27649:function(b,g,t){t.d(g,{o:function(){return i}});var e=t(32735),m=t(60216),s=t(83292);const n=s.default.main`
  // To prevent global outline on focus visible to force an outline when Main is focused
  &:focus-visible {
    outline: none;
  }
`,i=({labelledBy:o,...T})=>{const M=o||"main-content-title";return e.createElement(n,{"aria-labelledby":M,id:"main-content",tabIndex:-1,...T})};i.defaultProps={labelledBy:void 0},i.propTypes={labelledBy:m.string}},44647:function(b,g,t){t.d(g,{Z:function(){return m}});var e=t(74512);function m(s){return(0,e.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s,children:(0,e.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.681 2.804A9.64 9.64 0 0011.818 2C6.398 2 2 6.48 2 12c0 5.521 4.397 10 9.818 10 2.03 0 4.011-.641 5.67-1.835a9.987 9.987 0 003.589-4.831 1.117 1.117 0 00-.664-1.418 1.086 1.086 0 00-1.393.676 7.769 7.769 0 01-2.792 3.758 7.546 7.546 0 01-4.41 1.428V4.222h.002a7.492 7.492 0 013.003.625 7.61 7.61 0 012.5 1.762l.464.551-2.986 3.042a.186.186 0 00.129.316H22V3.317a.188.188 0 00-.112-.172.179.179 0 00-.199.04l-2.355 2.4-.394-.468-.02-.02a9.791 9.791 0 00-3.239-2.293zm-3.863 1.418V2v2.222zm0 0v15.556c-4.216 0-7.636-3.484-7.636-7.778s3.42-7.777 7.636-7.778z",fill:"#212134"})})}}}]);
